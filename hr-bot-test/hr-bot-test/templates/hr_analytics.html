
{% extends "base.html" %}

{% block title %}HR –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ - SapaHR{% endblock %}

{% block content %}
<div class="analytics-page">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ -->
    <div class="analytics-header">
        <div class="header-left">
            <h1>üìä HR –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h1>
            <p class="subtitle">–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ HR-–º–µ—Ç—Ä–∏–∫ –∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π</p>
        </div>
        <div class="header-right">
            <div class="date-filters">
                <button class="filter-btn active" data-period="week">–ù–µ–¥–µ–ª—è</button>
                <button class="filter-btn" data-period="month">–ú–µ—Å—è—Ü</button>
                <button class="filter-btn" data-period="year">–ì–æ–¥</button>
                <button class="filter-btn" data-period="custom">–í—ã–±—Ä–∞—Ç—å –¥–∞—Ç—ã</button>
            </div>
        </div>
    </div>

    <!-- –ö–∞—Å—Ç–æ–º–Ω—ã–π –≤—ã–±–æ—Ä –¥–∞—Ç -->
    <div class="custom-date-picker" id="customDatePicker" style="display: none;">
        <div class="date-inputs">
            <div class="date-input-group">
                <label>–û—Ç:</label>
                <input type="date" id="dateFrom" class="date-input">
            </div>
            <div class="date-input-group">
                <label>–î–æ:</label>
                <input type="date" id="dateTo" class="date-input">
            </div>
            <button class="btn-apply-dates" onclick="applyCustomDates()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ -->
    <div class="metrics-grid">
        <div class="metric-card blue">
            <div class="metric-icon">üë•</div>
            <div class="metric-content">
                <h3 id="totalEmployees">{{ stats.total_users }}</h3>
                <p>–í—Å–µ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</p>
                <span class="metric-change positive">+{{ stats.registered_today }} –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å–µ–≥–æ–¥–Ω—è</span>
            </div>
        </div>

        <div class="metric-card purple">
            <div class="metric-icon">üìã</div>
            <div class="metric-content">
                <h3 id="totalRequests">{{ stats.total_requests }}</h3>
                <p>–í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫</p>
                <span class="metric-change">{{ stats.pending_requests }} –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ</span>
            </div>
        </div>

        <div class="metric-card green">
            <div class="metric-icon">‚úÖ</div>
            <div class="metric-content">
                <h3 id="approvedRequests">{{ stats.approved_requests }}</h3>
                <p>–û–¥–æ–±—Ä–µ–Ω–æ –∑–∞—è–≤–æ–∫</p>
                <span class="metric-change positive">{{ stats.approval_rate }}% –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å</span>
            </div>
        </div>

        <div class="metric-card orange">
            <div class="metric-icon">üèñÔ∏è</div>
            <div class="metric-content">
                <h3 id="activeVacations">{{ stats.active_vacations }}</h3>
                <p>–ê–∫—Ç–∏–≤–Ω—ã—Ö –æ—Ç–ø—É—Å–∫–æ–≤</p>
                <span class="metric-change">{{ stats.vacation_days_total }} –¥–Ω–µ–π –≤—Å–µ–≥–æ</span>
            </div>
        </div>

        <div class="metric-card teal">
            <div class="metric-icon">üëÅÔ∏è</div>
            <div class="metric-content">
                <h3 id="visitorsToday">{{ stats.visitors_today }}</h3>
                <p>–ü–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π —Å–µ–≥–æ–¥–Ω—è</p>
                <span class="metric-change">{{ stats.total_visits_today }} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</span>
            </div>
        </div>

        <div class="metric-card pink">
            <div class="metric-icon">üìä</div>
            <div class="metric-content">
                <h3 id="totalPolls">{{ stats.total_polls }}</h3>
                <p>–í—Å–µ–≥–æ –æ–ø—Ä–æ—Å–æ–≤</p>
                <span class="metric-change positive">{{ stats.active_polls_count }} –∞–∫—Ç–∏–≤–Ω—ã—Ö</span>
            </div>
        </div>
    </div>

    <!-- –ì—Ä–∞—Ñ–∏–∫–∏ -->
    <div class="charts-section">
        <!-- –ì—Ä–∞—Ñ–∏–∫ –∑–∞—è–≤–æ–∫ -->
        <div class="chart-card">
            <div class="chart-header">
                <h3>üìà –î–∏–Ω–∞–º–∏–∫–∞ –∑–∞—è–≤–æ–∫</h3>
                <div class="chart-legend">
                    <span class="legend-item"><span class="dot blue"></span> –í—Å–µ–≥–æ</span>
                    <span class="legend-item"><span class="dot green"></span> –û–¥–æ–±—Ä–µ–Ω–æ</span>
                    <span class="legend-item"><span class="dot red"></span> –û—Ç–∫–ª–æ–Ω–µ–Ω–æ</span>
                </div>
            </div>
            <canvas id="requestsChart"></canvas>
        </div>

        <!-- –ì—Ä–∞—Ñ–∏–∫ –æ—Ç–ø—É—Å–∫–æ–≤ -->
        <div class="chart-card">
            <div class="chart-header">
                <h3>üèñÔ∏è –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–ø—É—Å–∫–æ–≤</h3>
            </div>
            <canvas id="vacationsChart"></canvas>
        </div>
    </div>

    <!-- –í—Ç–æ—Ä–∞—è –ª–∏–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ -->
    <div class="charts-section">
        <!-- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º –∑–∞—è–≤–æ–∫ -->
        <div class="chart-card">
            <div class="chart-header">
                <h3>üìä –¢–∏–ø—ã –∑–∞—è–≤–æ–∫</h3>
            </div>
            <canvas id="requestTypesChart"></canvas>
        </div>

        <!-- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –æ—Ç–¥–µ–ª–∞–º -->
        <div class="chart-card">
            <div class="chart-header">
                <h3>üè¢ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –æ—Ç–¥–µ–ª–∞–º</h3>
            </div>
            <canvas id="departmentsChart"></canvas>
        </div>
    </div>

    <!-- –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="detailed-stats">
        <div class="stats-card">
            <h3>üìã –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞—è–≤–æ–∫</h3>
            <table class="stats-table">
                <thead>
                    <tr>
                        <th>–ü–µ—Ä–∏–æ–¥</th>
                        <th>–í—Å–µ–≥–æ</th>
                        <th>–û–¥–æ–±—Ä–µ–Ω–æ</th>
                        <th>–û—Ç–∫–ª–æ–Ω–µ–Ω–æ</th>
                        <th>–í –æ–∂–∏–¥–∞–Ω–∏–∏</th>
                        <th>% –æ–¥–æ–±—Ä–µ–Ω–∏—è</th>
                    </tr>
                </thead>
                <tbody id="requestsStatsTable">
                    {% for stat in requests_stats %}
                    <tr>
                        <td>{{ stat.period }}</td>
                        <td>{{ stat.total }}</td>
                        <td class="success">{{ stat.approved }}</td>
                        <td class="danger">{{ stat.rejected }}</td>
                        <td class="warning">{{ stat.pending }}</td>
                        <td>
                            <div class="progress-bar-mini">
                                <div class="progress-fill" style="width: {{ stat.approval_rate }}%"></div>
                                <span>{{ stat.approval_rate }}%</span>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="stats-card">
            <h3>üë• –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º</h3>
            <table class="stats-table">
                <thead>
                    <tr>
                        <th>–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
                        <th>–û—Ç–¥–µ–ª</th>
                        <th>–ó–∞—è–≤–æ–∫</th>
                        <th>–û—Ç–ø—É—Å–∫–æ–≤</th>
                        <th>–ë–∞–ª–ª—ã</th>
                    </tr>
                </thead>
                <tbody id="employeeStatsTable">
                    {% for emp in employee_stats %}
                    <tr>
                        <td>
                            <div class="employee-info">
                                <div class="avatar-mini">{{ emp.initials }}</div>
                                {{ emp.name }}
                            </div>
                        </td>
                        <td>{{ emp.department or '–ù–µ —É–∫–∞–∑–∞–Ω' }}</td>
                        <td>{{ emp.requests_count }}</td>
                        <td>{{ emp.vacations_count }}</td>
                        <td><strong>{{ emp.points }}</strong></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- –ì—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
    <div class="chart-card full-width">
        <div class="chart-header">
            <h3>üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</h3>
        </div>
        <canvas id="activityCalendarChart"></canvas>
    </div>
</div>

<style>
.analytics-page {
    padding: 24px;
    background: #F5F7FA;
    min-height: 100vh;
}

.analytics-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
    flex-wrap: wrap;
    gap: 16px;
}

.header-left h1 {
    font-size: 28px;
    font-weight: 700;
    color: #1E293B;
    margin: 0 0 4px 0;
}

.subtitle {
    color: #64748B;
    font-size: 14px;
    margin: 0;
}

.date-filters {
    display: flex;
    gap: 8px;
    background: white;
    padding: 4px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}

.filter-btn {
    padding: 10px 20px;
    border: none;
    background: transparent;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    font-size: 14px;
    color: #64748B;
    transition: all 0.2s;
}

.filter-btn:hover {
    background: #F1F5F9;
    color: #1E293B;
}

.filter-btn.active {
    background: #6366F1;
    color: white;
}

.custom-date-picker {
    background: white;
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}

.date-inputs {
    display: flex;
    gap: 16px;
    align-items: flex-end;
}

.date-input-group {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.date-input-group label {
    font-size: 14px;
    font-weight: 600;
    color: #475569;
}

.date-input {
    padding: 10px 16px;
    border: 2px solid #E2E8F0;
    border-radius: 8px;
    font-size: 14px;
}

.date-input:focus {
    outline: none;
    border-color: #6366F1;
}

.btn-apply-dates {
    padding: 10px 24px;
    background: #6366F1;
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-apply-dates:hover {
    background: #5558E3;
}

.metrics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.metric-card {
    background: white;
    padding: 24px;
    border-radius: 16px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.08);
    display: flex;
    gap: 16px;
    align-items: center;
    border-left: 4px solid;
}

.metric-card.blue { border-left-color: #3B82F6; }
.metric-card.purple { border-left-color: #A855F7; }
.metric-card.green { border-left-color: #10B981; }
.metric-card.orange { border-left-color: #F59E0B; }
.metric-card.teal { border-left-color: #14B8A6; }
.metric-card.pink { border-left-color: #EC4899; }

.metric-icon {
    font-size: 40px;
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #F8FAFC;
    border-radius: 12px;
}

.metric-content {
    flex: 1;
}

.metric-content h3 {
    font-size: 32px;
    font-weight: 700;
    color: #1E293B;
    margin: 0 0 4px 0;
}

.metric-content p {
    color: #64748B;
    font-size: 14px;
    margin: 0 0 8px 0;
}

.metric-change {
    font-size: 12px;
    color: #64748B;
    font-weight: 600;
}

.metric-change.positive {
    color: #10B981;
}

.charts-section {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
    gap: 20px;
    margin-bottom: 20px;
}

.chart-card {
    background: white;
    padding: 24px;
    border-radius: 16px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.08);
}

.chart-card.full-width {
    grid-column: 1 / -1;
}

.chart-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 16px;
    border-bottom: 2px solid #F1F5F9;
}

.chart-header h3 {
    font-size: 18px;
    font-weight: 700;
    color: #1E293B;
    margin: 0;
}

.chart-legend {
    display: flex;
    gap: 16px;
}

.legend-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: #64748B;
    font-weight: 600;
}

.dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
}

.dot.blue { background: #3B82F6; }
.dot.green { background: #10B981; }
.dot.red { background: #EF4444; }

.detailed-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
    gap: 20px;
    margin-bottom: 20px;
}

.stats-card {
    background: white;
    padding: 24px;
    border-radius: 16px;
    box-shadow: 0 2px 12px rgba(0,0,0,0.08);
}

.stats-card h3 {
    font-size: 18px;
    font-weight: 700;
    color: #1E293B;
    margin: 0 0 20px 0;
}

.stats-table {
    width: 100%;
    border-collapse: collapse;
}

.stats-table thead {
    background: #F8FAFC;
}

.stats-table th {
    padding: 12px;
    text-align: left;
    font-size: 12px;
    font-weight: 700;
    color: #64748B;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.stats-table td {
    padding: 12px;
    border-bottom: 1px solid #F1F5F9;
    font-size: 14px;
    color: #475569;
}

.stats-table td.success {
    color: #10B981;
    font-weight: 600;
}

.stats-table td.danger {
    color: #EF4444;
    font-weight: 600;
}

.stats-table td.warning {
    color: #F59E0B;
    font-weight: 600;
}

.progress-bar-mini {
    position: relative;
    background: #F1F5F9;
    border-radius: 20px;
    height: 24px;
    overflow: hidden;
}

.progress-fill {
    background: linear-gradient(90deg, #10B981, #059669);
    height: 100%;
    border-radius: 20px;
    transition: width 0.3s;
}

.progress-bar-mini span {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 11px;
    font-weight: 700;
    color: #1E293B;
}

.employee-info {
    display: flex;
    align-items: center;
    gap: 10px;
}

.avatar-mini {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 700;
}

@media (max-width: 1200px) {
    .charts-section {
        grid-template-columns: 1fr;
    }
    
    .detailed-stats {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 768px) {
    .analytics-header {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .date-filters {
        width: 100%;
        flex-wrap: wrap;
    }
    
    .metrics-grid {
        grid-template-columns: 1fr;
    }
}
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script>
// –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        
        const period = this.dataset.period;
        if (period === 'custom') {
            document.getElementById('customDatePicker').style.display = 'block';
        } else {
            document.getElementById('customDatePicker').style.display = 'none';
            loadDataForPeriod(period);
        }
    });
});

function applyCustomDates() {
    const dateFrom = document.getElementById('dateFrom').value;
    const dateTo = document.getElementById('dateTo').value;
    
    if (dateFrom && dateTo) {
        loadDataForCustomPeriod(dateFrom, dateTo);
    }
}

function loadDataForPeriod(period) {
    fetch(`/api/analytics/data?period=${period}`)
        .then(response => response.json())
        .then(data => {
            updateMetrics(data.metrics);
            updateCharts(data.charts);
            updateTables(data.tables);
        })
        .catch(error => console.error('Error:', error));
}

function loadDataForCustomPeriod(dateFrom, dateTo) {
    fetch(`/api/analytics/data?date_from=${dateFrom}&date_to=${dateTo}`)
        .then(response => response.json())
        .then(data => {
            updateMetrics(data.metrics);
            updateCharts(data.charts);
            updateTables(data.tables);
        })
        .catch(error => console.error('Error:', error));
}

// –ì—Ä–∞—Ñ–∏–∫ –∑–∞—è–≤–æ–∫
const requestsCtx = document.getElementById('requestsChart').getContext('2d');
const requestsChart = new Chart(requestsCtx, {
    type: 'line',
    data: {
        labels: {{ requests_chart_labels|tojson }},
        datasets: [
            {
                label: '–í—Å–µ–≥–æ',
                data: {{ requests_chart_total|tojson }},
                borderColor: '#3B82F6',
                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                tension: 0.4,
                fill: true
            },
            {
                label: '–û–¥–æ–±—Ä–µ–Ω–æ',
                data: {{ requests_chart_approved|tojson }},
                borderColor: '#10B981',
                backgroundColor: 'rgba(16, 185, 129, 0.1)',
                tension: 0.4,
                fill: true
            },
            {
                label: '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ',
                data: {{ requests_chart_rejected|tojson }},
                borderColor: '#EF4444',
                backgroundColor: 'rgba(239, 68, 68, 0.1)',
                tension: 0.4,
                fill: true
            }
        ]
    },
    options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
            legend: {
                display: false
            }
        },
        scales: {
            y: {
                beginAtZero: true,
                ticks: {
                    stepSize: 1
                }
            }
        }
    }
});

// –ì—Ä–∞—Ñ–∏–∫ –æ—Ç–ø—É—Å–∫–æ–≤
const vacationsCtx = document.getElementById('vacationsChart').getContext('2d');
const vacationsChart = new Chart(vacationsCtx, {
    type: 'bar',
    data: {
        labels: {{ vacations_chart_labels|tojson }},
        datasets: [{
            label: '–î–Ω–µ–π –æ—Ç–ø—É—Å–∫–∞',
            data: {{ vacations_chart_data|tojson }},
            backgroundColor: 'rgba(168, 85, 247, 0.7)',
            borderColor: '#A855F7',
            borderWidth: 2,
            borderRadius: 8
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
            legend: {
                display: false
            }
        },
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});

// –ì—Ä–∞—Ñ–∏–∫ —Ç–∏–ø–æ–≤ –∑–∞—è–≤–æ–∫
const requestTypesCtx = document.getElementById('requestTypesChart').getContext('2d');
const requestTypesChart = new Chart(requestTypesCtx, {
    type: 'doughnut',
    data: {
        labels: {{ request_types_labels|tojson }},
        datasets: [{
            data: {{ request_types_data|tojson }},
            backgroundColor: [
                '#3B82F6',
                '#10B981',
                '#F59E0B',
                '#EF4444',
                '#8B5CF6',
                '#EC4899'
            ],
            borderWidth: 0
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
            legend: {
                position: 'right'
            }
        }
    }
});

// –ì—Ä–∞—Ñ–∏–∫ –ø–æ –æ—Ç–¥–µ–ª–∞–º
const departmentsCtx = document.getElementById('departmentsChart').getContext('2d');
const departmentsChart = new Chart(departmentsCtx, {
    type: 'bar',
    data: {
        labels: {{ departments_labels|tojson }},
        datasets: [{
            label: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            data: {{ departments_data|tojson }},
            backgroundColor: 'rgba(99, 102, 241, 0.7)',
            borderColor: '#6366F1',
            borderWidth: 2,
            borderRadius: 8
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: true,
        indexAxis: 'y',
        plugins: {
            legend: {
                display: false
            }
        },
        scales: {
            x: {
                beginAtZero: true
            }
        }
    }
});

// –ì—Ä–∞—Ñ–∏–∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
const activityCtx = document.getElementById('activityCalendarChart').getContext('2d');
const activityChart = new Chart(activityCtx, {
    type: 'line',
    data: {
        labels: {{ activity_labels|tojson }},
        datasets: [{
            label: '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            data: {{ activity_data|tojson }},
            borderColor: '#6366F1',
            backgroundColor: 'rgba(99, 102, 241, 0.1)',
            tension: 0.4,
            fill: true,
            pointRadius: 4,
            pointHoverRadius: 6
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
            legend: {
                display: false
            }
        },
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});

function updateMetrics(metrics) {
    document.getElementById('totalEmployees').textContent = metrics.total_users;
    document.getElementById('totalRequests').textContent = metrics.total_requests;
    document.getElementById('approvedRequests').textContent = metrics.approved_requests;
    document.getElementById('activeVacations').textContent = metrics.active_vacations;
    document.getElementById('visitorsToday').textContent = metrics.visitors_today;
    document.getElementById('totalPolls').textContent = metrics.total_polls;
}

function updateCharts(charts) {
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
    requestsChart.data.labels = charts.requests.labels;
    requestsChart.data.datasets[0].data = charts.requests.total;
    requestsChart.data.datasets[1].data = charts.requests.approved;
    requestsChart.data.datasets[2].data = charts.requests.rejected;
    requestsChart.update();
    
    vacationsChart.data.labels = charts.vacations.labels;
    vacationsChart.data.datasets[0].data = charts.vacations.data;
    vacationsChart.update();
    
    requestTypesChart.data.labels = charts.types.labels;
    requestTypesChart.data.datasets[0].data = charts.types.data;
    requestTypesChart.update();
    
    departmentsChart.data.labels = charts.departments.labels;
    departmentsChart.data.datasets[0].data = charts.departments.data;
    departmentsChart.update();
    
    activityChart.data.labels = charts.activity.labels;
    activityChart.data.datasets[0].data = charts.activity.data;
    activityChart.update();
}

function updateTables(tables) {
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
    const requestsTable = document.getElementById('requestsStatsTable');
    const employeeTable = document.getElementById('employeeStatsTable');
    
    // –õ–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü
}
</script>
{% endblock %}
